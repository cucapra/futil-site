name: Deploy
on: [push]

jobs:
    deploy:
        name: Deploy
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v2
            - name: Install Rust
              uses: actions-rs/toolchain@v1
              with:
                  profile: minimal
                  toolchain: stable
            - name: Install wasm-pack
              uses: jetli/wasm-pack-action@v0.2.0
            - name: Cache npm
              uses: actions/cache@v1
              with:
                path: ~/.npm
                key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
                restore-keys: |
                  ${{ runner.os }}-node-
            - run: npm install
            - name: Cache cargo build
              uses: actions/cache@v1
              with:
                  path: rust/target
                  key: cargo-build-${{ hashFiles('**/Cargo.lock') }}
            - name: Build
              run: npm run build
